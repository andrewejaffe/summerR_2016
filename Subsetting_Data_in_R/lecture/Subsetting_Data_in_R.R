## ---- echo = FALSE-------------------------------------------------------
library(knitr)
opts_chunk$set(comment = "")

## ------------------------------------------------------------------------
x = c(1, 4, 2, 8, 10)
x[2]

## ------------------------------------------------------------------------
x = c(1, 2, 4, 8, 10)
x[5]
x[c(2,5)]

## ----negativeIndex-------------------------------------------------------
x[-2] # all but the second

## ----negativeIndex2------------------------------------------------------
x[-c(1,2,3)] # drop first 3
# x[-1:3] # shorthand. R sees as -1 to 3
x[-(1:3)] # needs parentheses

## ------------------------------------------------------------------------
x
x > 2
x[ x > 2 ]

## ------------------------------------------------------------------------
x[ x > 2 & x < 5 ]
x[ x > 5 | x == 2 ]

## ------------------------------------------------------------------------
which(x > 5 | x == 2) # returns index
x[ which(x > 5 | x == 2) ]
x[ x > 5 | x == 2 ]

## ------------------------------------------------------------------------
set.seed(2016) # reproducbility
df = data.frame(x = c(1, 2, 4, 10, 10),
                x2 = rpois(5, 10),
                y = rnorm(5),
                z = rpois(5, 6)
                )

## ------------------------------------------------------------------------
colnames(df) = c("x", "X", "y", "z")
head(df)
colnames(df) = c("x", "x2", "y", "z") #reset

## ------------------------------------------------------------------------
cn = colnames(df)
cn[ cn == "x2"] = "X"
colnames(df) = cn
head(df)
colnames(df) = c("x", "x2", "y", "z") #reset

## ------------------------------------------------------------------------
library(dplyr)

## ------------------------------------------------------------------------
filter

## ------------------------------------------------------------------------
head(stats::filter,2)

## ------------------------------------------------------------------------
df = dplyr::rename(df, X = x2)
head(df)
df = dplyr::rename(df, x2 = X) # reset

## ------------------------------------------------------------------------
df$x

## ------------------------------------------------------------------------
df[, 1]
df[, "x"]

## ------------------------------------------------------------------------
df[, c("x", "y")]

## ------------------------------------------------------------------------
select(df, x)

## ------------------------------------------------------------------------
select(df, x, x2)
select(df, starts_with("x"))

## ------------------------------------------------------------------------
df[ c(1, 3), ]

## ------------------------------------------------------------------------
df[ df$x > 5 | df$x == 2, ]

## ------------------------------------------------------------------------
df[ df$x > 5 | df$x == 2, c("y", "z")]

## ------------------------------------------------------------------------
filter(df, x > 5 | x == 2)

## ------------------------------------------------------------------------
filter(df, x > 2 & y < 0)
filter(df, x > 2, y < 0)

## ------------------------------------------------------------------------
select(filter(df, x > 2 & y < 0), y, z)

## ------------------------------------------------------------------------
df2 = filter(df, x > 2 & y < 0)
df2 = select(df2, y, z)

## ------------------------------------------------------------------------
df %>% filter(x > 2 & y < 0) %>% select(y, z)

## ------------------------------------------------------------------------
df$newcol = 5:1
df$newcol = df$x + 2

## ------------------------------------------------------------------------
df$newcol = NULL

## ------------------------------------------------------------------------
df = df[, colnames(df) != "newcol"]

## ------------------------------------------------------------------------
cbind(df, newcol = 5:1)

## ------------------------------------------------------------------------
mutate(df, newcol = 5:1)
print({df = mutate(df, newcol = x + 2)})

## ------------------------------------------------------------------------
select(df, -newcol)

## ------------------------------------------------------------------------
select(df, -one_of("newcol", "y"))

## ------------------------------------------------------------------------
cn = colnames(df)
df[, c("newcol", cn[cn != "newcol"]) ]

## ------------------------------------------------------------------------
select(df, newcol, everything())

## ------------------------------------------------------------------------
df[ order(df$x), ]

## ------------------------------------------------------------------------
df[ order(df$x, decreasing = TRUE), ]

## ------------------------------------------------------------------------
df[ order(df$x, -df$y), ]

## ------------------------------------------------------------------------
arrange(df, x)

## ------------------------------------------------------------------------
arrange(df, desc(x))

## ------------------------------------------------------------------------
arrange(df, x, desc(y))

## ------------------------------------------------------------------------
transmute(df, newcol2 = x * 3, x, y)

